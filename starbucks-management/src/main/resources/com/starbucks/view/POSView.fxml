<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import java.net.URL?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="750.0" prefWidth="1200.0" xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.starbucks.controller_fx.POSControllerFx">
    <stylesheets>
        <URL value="@/com/starbucks/css/pos-styles.css" />
    </stylesheets>
    
    <top>
        <HBox alignment="CENTER_LEFT" prefHeight="40.0" style="-fx-background-color: #6A1B9A;" BorderPane.alignment="CENTER">
            <Label text="M6402 - 16402" textFill="WHITE" style="-fx-font-weight: bold; -fx-padding: 0 0 0 10;"/>
            <Label text="0002" textFill="WHITE" style="-fx-font-weight: bold; -fx-padding: 0 10 0 750;"/>
        </HBox>
    </top>
    
    <left>
        <!-- Cột Trái được tăng kích thước để khớp với TableView -->
        <VBox prefWidth="400.0" style="-fx-background-color: #E0E0E0;" BorderPane.alignment="CENTER"> 
            <!-- ... (Các Label) ... -->
            
            <TableView fx:id="orderTableView" VBox.vgrow="ALWAYS" minHeight="500.0" style="-fx-border-color: #A0A0A0; -fx-border-width: 1;">
                <columns>
                    <TableColumn fx:id="itemCol" prefWidth="300.0" text="Sản phẩm" >
                        <cellValueFactory><PropertyValueFactory property="name" /></cellValueFactory>
                    </TableColumn>
                    <TableColumn fx:id="priceCol" prefWidth="100.0" text="Giá tiền" >
                         <cellValueFactory><PropertyValueFactory property="price" /></cellValueFactory>
                    </TableColumn>
                </columns>
                <columnResizePolicy>
                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                </columnResizePolicy>
            </TableView>
            
            <!-- Khu vực tổng tiền -->
            <HBox alignment="CENTER_RIGHT" prefHeight="50.0" style="-fx-background-color: black;">
                <Label text="TỔNG CỘNG:" textFill="WHITE" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-padding: 0 10 0 0;"/>
                <Label fx:id="totalLabel" text="0" textFill="WHITE" style="-fx-font-size: 36; -fx-font-weight: bold; -fx-padding: 0 20 0 0;"/>
            </HBox>
        </VBox>
    </left>
    
    <center>
        <VBox BorderPane.alignment="CENTER">
            
            <!-- Hàng 2 nút Menu (HOT ESP, ICED ESP) -->
            <GridPane hgap="5" vgap="5" prefHeight="60.0" VBox.vgrow="NEVER" style="-fx-padding: 5;"> 
                <columnConstraints>
                    <ColumnConstraints hgrow="ALWAYS" percentWidth="50.0" />
                    <ColumnConstraints hgrow="ALWAYS" percentWidth="50.0" />
                </columnConstraints>
                <Button text="HOT ESP" GridPane.columnIndex="0" styleClass="pos-button, menu-button" onAction="#handleCategorySelect" userData="HOT" maxWidth="Infinity" maxHeight="Infinity"/>
                <Button text="ICED ESP" GridPane.columnIndex="1" styleClass="pos-button, menu-button" onAction="#handleCategorySelect" userData="ICED" maxWidth="Infinity" maxHeight="Infinity"/>
            </GridPane>

            <!-- BƯỚC SỬA LỖI: ĐẶT GRIDPANE VÀO SCROLLPANE -->
            <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" style="-fx-padding: 0;">
                <content>
                    <!-- Grid Sản phẩm: LOẠI BỎ H/VGAP VÀ PADDING ĐỂ NÚT DÍNH VÀO NHAU (Lại có khoảng cách nếu dùng ScrollPane) -->
                    <!-- SỬ DỤNG H/VGAP = 5 LẠI ĐỂ CÓ KHOẢNG CÁCH NHỎ ĐỀU NHAU -->
                    <GridPane fx:id="productGrid" hgap="5" vgap="5" style="-fx-padding: 5;"> 
                        <columnConstraints>
                            <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                            <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                            <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                            <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints vgrow="ALWAYS" percentHeight="33.33" /> 
                            <RowConstraints vgrow="ALWAYS" percentHeight="33.33" /> 
                            <RowConstraints vgrow="ALWAYS" percentHeight="33.33" /> 
                        </rowConstraints>
                    </GridPane>
                </content>
            </ScrollPane>
            
            
<!-- Hàng 4 nút chức năng (CLEAR ALL, VOID, EXIT, THANH TOÁN) -->
            <GridPane hgap="5" vgap="5" prefHeight="100.0" VBox.vgrow="NEVER" style="-fx-padding: 5;"> 
                <columnConstraints>
                    <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                    <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                    <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                    <ColumnConstraints hgrow="ALWAYS" percentWidth="25.0" /> 
                </columnConstraints>
                <rowConstraints>
                    <RowConstraints vgrow="ALWAYS" />
                </rowConstraints>
                
                <Button text="CLEAR ALL" GridPane.columnIndex="0" styleClass="pos-button, clear-void-button" onAction="#handleClearAll" maxWidth="Infinity" maxHeight="Infinity"/>
                <Button text="VOID" GridPane.columnIndex="1" styleClass="pos-button, clear-void-button" onAction="#handleVoidItem" maxWidth="Infinity" maxHeight="Infinity"/>
                <Button text="EXIT" GridPane.columnIndex="2" styleClass="pos-button, exit-button" onAction="#handleExitPOS" maxWidth="Infinity" maxHeight="Infinity"/>
                <Button text="THANH TOÁN" GridPane.columnIndex="3" styleClass="pos-button, func-button" onAction="#handlePayment" maxWidth="Infinity" maxHeight="Infinity"/>
            </GridPane>
        </VBox>
    </center>
</BorderPane>